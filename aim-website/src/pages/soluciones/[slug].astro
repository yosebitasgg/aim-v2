---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { agents } from '../../data/agents';
import { Icon } from 'astro-icon/components';

// Generate static paths for all agents
export async function getStaticPaths() {
  return agents.map((agent) => ({
    params: { slug: agent.slug },
  }));
}

// Get the agent based on the slug from the URL
const { slug } = Astro.params;
const agent = agents.find(a => a.slug === slug);

// If no agent found, return 404
if (!agent) {
  return new Response(null, { status: 404 });
}
---

<BaseLayout title={agent.title} description={agent.short_description}>
  <!-- Hero de la Solución -->
  <div class="bg-brand-light py-20">
    <div class="container mx-auto px-4 max-w-4xl">
      <p class="font-bold text-brand-primary uppercase">{agent.category}</p>
      <h1 class="mt-2 text-4xl md:text-5xl font-black text-brand-dark">{agent.title}</h1>
      <p class="mt-4 text-xl text-brand-gray">{agent.short_description}</p>
    </div>
  </div>

  <!-- Contenido Principal -->
  <div class="py-20">
    <div class="container mx-auto px-4 max-w-4xl grid grid-cols-1 md:grid-cols-3 gap-12">
      <!-- Columna Principal -->
      <div class="md:col-span-2">
        <div class="space-y-12">
          {agent.challenge && (
            <div>
              <h2 class="text-2xl font-bold text-brand-dark">El Desafío</h2>
              <p class="mt-4 text-brand-gray">{agent.challenge}</p>
            </div>
          )}
          {agent.solution && (
            <div>
              <h2 class="text-2xl font-bold text-brand-dark">La Solución AIM</h2>
              <p class="mt-4 text-brand-gray">{agent.solution}</p>
            </div>
          )}
        </div>
      </div>

      <!-- Barra Lateral -->
      <aside>
        <div class="bg-white p-6 rounded-lg border border-slate-200 sticky top-28">
            <h3 class="text-lg font-bold text-brand-dark">Capacidades Clave</h3>
            <ul class="mt-4 space-y-3">
              {agent.features && agent.features.map(feature => (
                <li class="flex items-start">
                  <Icon name="tabler:check" class="w-5 h-5 text-green-500 mr-2 flex-shrink-0 mt-1" />
                  <span>{feature}</span>
                </li>
              ))}
            </ul>
            <a href="/contacto" class="w-full text-center font-bold py-3 px-5 rounded-lg transition-all duration-300 mt-8 block bg-brand-primary hover:bg-brand-secondary text-white">
                Solicitar una Cotización
            </a>
        </div>
      </aside>

    </div>
  </div>
</BaseLayout> 